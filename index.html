<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>UNILAG Post-UTME Mock CBT — 100 Questions</title>
<style>
  :root{
    --green-1:#005a2b; --green-2:#1f8a3e; --gold:#ffd400;
    --card:#ffffff; --bg:#eaf6ec; --muted:#556b5a;
  }
  *{box-sizing:border-box}
  body{
    margin:0; font-family:Inter, system-ui, -apple-system, "Segoe UI", Roboto, Arial;
    background: linear-gradient(180deg,#dff3e0 0%, #eaf6ec 100%); color:#06331a;
    -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
  }
  .wrap{max-width:1000px;margin:18px auto;padding:18px}
  header{display:flex;gap:14px;align-items:center}
  .logo{width:72px;height:72px;border-radius:12px;background:linear-gradient(135deg,var(--green-2),var(--green-1));display:flex;align-items:center;justify-content:center;font-weight:800;color:#fff;font-size:20px}
  h1{margin:0;font-size:20px;color:var(--green-1)}
  p.lead{margin:6px 0 12px;color:var(--muted)}
  .card{background:var(--card);border-radius:12px;padding:18px;box-shadow:0 6px 30px rgba(2,6,23,0.08)}
  .topbar{display:flex;gap:12px;align-items:center;flex-wrap:wrap;margin-bottom:12px}
  .btn{background:var(--gold);color:#06331a;padding:8px 12px;border-radius:10px;border:none;cursor:pointer;font-weight:700}
  .btn.ghost{background:transparent;color:var(--green-2);border:1px solid rgba(6,51,26,0.08)}
  .timer{margin-left:auto;font-weight:800;background:#f5f9f5;padding:6px 10px;border-radius:10px;color:var(--green-2)}
  .progress{height:10px;background:#f0f6f0;border-radius:999px;overflow:hidden;margin:12px 0}
  .progress > i{display:block;height:100%;background:linear-gradient(90deg,var(--green-2),#3bb24a);width:0%}
  .question-card{padding:16px;border-radius:10px;background:linear-gradient(180deg,#fff,#fbfffb)}
  .qmeta{display:flex;gap:8px;align-items:center;margin-bottom:8px}
  .qnum{font-weight:800;color:var(--green-1)}
  .subject-pill{display:inline-block;padding:6px 10px;border-radius:999px;background:#eef7ee;color:var(--green-2);font-weight:700;margin-bottom:10px}
  .qtext{font-size:18px;margin:8px 0;color:#103a1f}
  .choices{display:grid;grid-template-columns:1fr 1fr;gap:8px}
  @media(max-width:760px){ .choices{grid-template-columns:1fr} }
  label.choice{display:flex;align-items:center;gap:10px;padding:12px;border-radius:10px;background:#f6fff6;border:1px solid #e6f3e6;cursor:pointer}
  input[type=radio]{width:16px;height:16px}
  .navs{display:flex;flex-wrap:wrap;gap:8px;margin-top:12px}
  .qnav{width:44px;height:38px;border-radius:8px;border:none;background:#f3fbf3;color:var(--muted);cursor:pointer;border:1px solid #e6f3e6}
  .qnav.answered{background:linear-gradient(90deg,var(--gold),#ffea7a);color:#06331a;box-shadow:0 6px 18px rgba(0,0,0,0.06)}
  .qnav.flag{outline:2px dashed #ffb74d}
  .footer-actions{display:flex;gap:10px;align-items:center;margin-top:14px;flex-wrap:wrap}
  .small{font-size:13px;color:var(--muted)}
  .result{margin-top:14px;padding:12px;border-radius:10px;background:#fbfff9;display:none}
  .breakdown{display:flex;gap:12px;flex-wrap:wrap;margin-top:10px}
  .badge{padding:8px 12px;border-radius:999px;background:#f0fff0;font-weight:700;color:var(--green-1)}
  footer.credits{color:var(--muted);font-size:13px;margin-top:18px;text-align:center}
</style>
</head>
<body>
<div class="wrap">
  <header>
    <div class="logo">UNILAG</div>
    <div>
      <h1>UNILAG Post-UTME — Mock CBT (100 Questions)</h1>
      <p class="lead">One-by-one CBT (JAMB style). Duration: <strong>90 minutes</strong>. Sections: English, Mathematics, General Knowledge, Logic.</p>
    </div>
  </header>

  <div class="card" id="app">
    <div class="topbar">
      <button class="btn" id="startBtn">Start Mock (90 mins)</button>
      <button class="btn ghost" id="flagBtn" title="Flag/Unflag current question">Flag/Unflag</button>
      <button class="btn ghost" id="saveBtn" title="Save progress to device">Save Progress</button>
      <button class="btn ghost" id="loadBtn" title="Load saved progress">Load Progress</button>
      <div class="timer" id="timer">Not started</div>
    </div>

    <div class="progress"><i id="progBar"></i></div>

    <div class="question-card">
      <div class="qmeta">
        <div class="qnum" id="qNum">Q1</div>
        <div class="subject-pill" id="qSubject">Subject</div>
        <div class="small" id="qTopic"></div>
      </div>

      <div class="qtext" id="qText">Press <strong>Start Mock</strong> to begin.</div>

      <div class="choices" id="choicesArea"></div>

      <div class="footer-actions">
        <div class="small">Navigate:</div>
        <button class="btn ghost" id="prevBtn">Previous</button>
        <button class="btn" id="nextBtn">Next</button>
        <button class="btn ghost" id="submitBtn">Submit & Finish</button>
        <div style="margin-left:auto" class="small">Answered: <span id="answeredCount">0</span>/100</div>
      </div>

      <div class="navs" id="navs"></div>

      <div class="result" id="resultBox">
        <div id="scoreText" style="font-size:18px;font-weight:800"></div>
        <div class="breakdown" id="breakdown"></div>
        <div style="margin-top:10px"><button class="btn" id="retryBtn">Retry (clear & restart)</button> <button class="btn ghost" id="exportBtn">Export Results</button></div>
      </div>
    </div>
  </div>

  <footer class="credits">Open in Chrome (mobile or desktop). Your answers are stored locally only.</footer>
</div>

<script>
/* ----------------------
   FULL 100 QUESTIONS (fixed)
   ---------------------- */
const QUESTIONS = [
  {q:"1. What is the study of birds called?", a:["Ornithology","Biology","Hematology","Nigerology"], correct:0, topic:'English'},
  {q:"2. What is the capital of Yobe State?", a:["Damaturu","Kano","Minna","Ilorin"], correct:0, topic:'GK'},
  {q:"3. When was EFCC established (year)?", a:["1979","1993","2003","1985"], correct:2, topic:'GK'},
  {q:"4. Choose the correctly punctuated sentence.", a:["Its cold outside.","It's cold outside.","Its' cold outside.","It is' cold outside."], correct:1, topic:'English'},
  {q:"5. Which is an antonym of 'scarce'?", a:["Rare","Abundant","Insufficient","Limited"], correct:1, topic:'English'},
  {q:"6. Fill in the blank: He _____ to Lagos every weekend.", a:["go","goes","gone","going"], correct:1, topic:'English'},
  {q:"7. She showed great _____ when she forgave him.", a:["vengeance","malice","mercy","spite"], correct:2, topic:'English'},
  {q:"8. Identify the adverb in: 'She quickly finished her homework.'", a:["She","quickly","finished","homework"], correct:1, topic:'English'},
  {q:"9. Which is a collective noun?", a:["A flock of birds","A small","Birds","Flocking"], correct:0, topic:'English'},
  {q:"10. Pick the correct plural of 'Analysis'.", a:["Analysises","Analyses","Analysii","Analys"], correct:1, topic:'English'},

  {q:"11. What is 12 × 15?", a:["170","180","150","200"], correct:1, topic:'Maths'},
  {q:"12. Simplify: 3x + 5x", a:["15x","8x","2x","-2x"], correct:1, topic:'Maths'},
  {q:"13. If x = 4, evaluate 2x^2 - x", a:["24","28","30","26"], correct:0, topic:'Maths'},
  {q:"14. What is 25% of 240?", a:["60","50","70","80"], correct:0, topic:'Maths'},
  {q:"15. Solve for y: y/3 = 9", a:["27","3","12","6"], correct:0, topic:'Maths'},
  {q:"16. Find LCM of 6 and 8.", a:["24","48","12","6"], correct:0, topic:'Maths'},
  {q:"17. What is the next prime after 13?", a:["15","17","16","19"], correct:1, topic:'Maths'},
  {q:"18. Simplify: (2+3) × 4", a:["20","14","24","18"], correct:0, topic:'Maths'},
  {q:"19. Right triangle legs 3 and 4. Hypotenuse is?", a:["5","6","7","4"], correct:0, topic:'Maths'},
  {q:"20. If angle A = 90°, triangle is ___?", a:["Obtuse","Right","Acute","Equilateral"], correct:1, topic:'Maths'},

  {q:"21. Who wrote 'Things Fall Apart'?", a:["Chinua Achebe","Wole Soyinka","Chimamanda Adichie","Ngugi wa Thiong'o"], correct:0, topic:'GK'},
  {q:"22. The capital of Nigeria is?", a:["Lagos","Abuja","Kano","Port Harcourt"], correct:1, topic:'GK'},
  {q:"23. The Nile river is primarily associated with which country?", a:["Brazil","Egypt","Canada","India"], correct:1, topic:'GK'},
  {q:"24. H2O is the chemical formula for?", a:["Oxygen","Hydrogen","Water","Salt"], correct:2, topic:'GK'},
  {q:"25. Which gas do plants produce during photosynthesis?", a:["Nitrogen","Oxygen","Carbon Dioxide","Hydrogen"], correct:1, topic:'GK'},
  {q:"26. The UN headquarters is in which city?", a:["Geneva","New York","Paris","London"], correct:1, topic:'GK'},
  {q:"27. Who is known as the 'Father of Computers'?", a:["Alan Turing","Charles Babbage","Bill Gates","Steve Jobs"], correct:1, topic:'GK'},
  {q:"28. The largest ocean is?", a:["Atlantic","Indian","Arctic","Pacific"], correct:3, topic:'GK'},
  {q:"29. Boiling point of water at sea level (°C)?", a:["90","100","80","120"], correct:1, topic:'GK'},
  {q:"30. Which country is Lagos located in?", a:["Ghana","Nigeria","Kenya","Sierra Leone"], correct:1, topic:'GK'},

  {q:"31. Book is to Reading as Knife is to ____.", a:["Cutting","Cooking","Eating","Sharpening"], correct:0, topic:'English'},
  {q:"32. Which sentence uses future tense?", a:["I eat lunch.","I will eat lunch.","I ate lunch.","I have eaten lunch."], correct:1, topic:'English'},
  {q:"33. Which of these is a preposition?", a:["Quickly","Under","Beautiful","Run"], correct:1, topic:'English'},
  {q:"34. Comparative of 'Young'?", a:["Youngest","More young","Younger","Most young"], correct:2, topic:'English'},
  {q:"35. Correct spelling:", a:["Maintenance","Maintanance","Maintnance","Maitenance"], correct:0, topic:'English'},
  {q:"36. Example of onomatopoeia:", a:["Bang","Blue","Quick","Large"], correct:0, topic:'English'},
  {q:"37. Identify the noun: 'The cat slept on the mat.'", a:["slept","on","cat","the"], correct:2, topic:'English'},
  {q:"38. Homophone for 'sea' in 'He sailed on the ___.'", a:["see","sie","cee","se"], correct:0, topic:'English'},
  {q:"39. Root word of 'happiness'?", a:["happy","happi","ness","hap"], correct:0, topic:'English'},
  {q:"40. Which sentence is grammatically correct?", a:["She don't like tea.","She doesn't like tea.","She aren't like tea.","She isn't likes tea."], correct:1, topic:'English'},

  {q:"41. What is 144 ÷ 12?", a:["11","12","13","10"], correct:1, topic:'Maths'},
  {q:"42. Solve: 7(2 + 3).", a:["35","21","14","70"], correct:0, topic:'Maths'},
  {q:"43. If 5x = 45, x = ?", a:["9","8","10","7"], correct:0, topic:'Maths'},
  {q:"44. Convert 0.25 to fraction.", a:["1/4","1/3","2/5","1/5"], correct:0, topic:'Maths'},
  {q:"45. Perimeter of square side 6 is?", a:["12","24","36","30"], correct:1, topic:'Maths'},
  {q:"46. If probability of A is 1/2, odds in favor are?", a:["1:1","1:2","2:1","1:3"], correct:0, topic:'Maths'},
  {q:"47. Simplify: 10 - (2+3).", a:["3","5","0","10"], correct:0, topic:'Maths'},
  {q:"48. Cube of 3 is?", a:["6","9","27","81"], correct:2, topic:'Maths'},
  {q:"49. Which is an even prime number?", a:["1","2","3","5"], correct:1, topic:'Maths'},
  {q:"50. 0 ÷ 5 = ?", a:["0","5","Undefined","1"], correct:0, topic:'Maths'},

  {q:"51. Nobel Peace Prize 1993 joint winners?", a:["Nelson Mandela & F.W. de Klerk","Mother Teresa","Kofi Annan","Barack Obama"], correct:0, topic:'GK'},
  {q:"52. The Great Wall is located in which country?", a:["China","India","Mexico","Peru"], correct:0, topic:'GK'},
  {q:"53. Which planet is the Red Planet?", a:["Venus","Earth","Mars","Jupiter"], correct:2, topic:'GK'},
  {q:"54. Who discovered penicillin?", a:["Alexander Fleming","Louis Pasteur","Isaac Newton","Marie Curie"], correct:0, topic:'GK'},
  {q:"55. Currency of Japan?", a:["Yen","Dollar","Euro","Won"], correct:0, topic:'GK'},
  {q:"56. Which organ pumps blood around the body?", a:["Liver","Lung","Heart","Kidney"], correct:2, topic:'GK'},
  {q:"57. Which continent is Nigeria in?", a:["Asia","Africa","Europe","Oceania"], correct:1, topic:'GK'},
  {q:"58. Water cycle includes evaporation, condensation and ___?", a:["Infiltration","Precipitation","Sedimentation","Distillation"], correct:1, topic:'GK'},
  {q:"59. Who wrote 'A Long Walk to Freedom'?", a:["Nelson Mandela","Wole Soyinka","Chinua Achebe","J.K. Rowling"], correct:0, topic:'GK'},
  {q:"60. Chemical symbol for Gold?", a:["Gd","Au","Ag","Go"], correct:1, topic:'GK'},

  {q:"61. Which word means 'able to be trusted'?", a:["reliable","erratic","fickle","vague"], correct:0, topic:'English'},
  {q:"62. Choose correct: 'Neither of the boys _____ finished.'", a:["has","have","are","isn't"], correct:0, topic:'English'},
  {q:"63. Part of speech: 'Kindness'", a:["Verb","Noun","Adverb","Adjective"], correct:1, topic:'English'},
  {q:"64. Synonym for 'rapid'?", a:["slow","swift","lethargic","late"], correct:1, topic:'English'},
  {q:"65. Which prefix makes 'possible' mean 'not possible'?", a:["un-","re-","in-","non-"], correct:2, topic:'English'},
  {q:"66. Plural of 'Child' is?", a:["Childs","Children","Childes","Childrens"], correct:1, topic:'English'},
  {q:"67. 'They have eaten' is in which tense?", a:["Present perfect","Simple past","Future perfect","Present continuous"], correct:0, topic:'English'},
  {q:"68. Which is an interjection?", a:["Wow!","Quickly","Beautiful","Table"], correct:0, topic:'English'},
  {q:"69. 'Tallest' is a ___ (in 'He is the tallest of the three').", a:["comparative","superlative","positive","none"], correct:1, topic:'English'},
  {q:"70. Choose correct conjunction: 'I like tea ___ I don't like coffee.'", a:["and","but","or","so"], correct:1, topic:'English'},

  {q:"71. If f(x)=2x+3, f(4)=?", a:["11","10","8","9"], correct:0, topic:'Maths'},
  {q:"72. 15% of 200 = ?", a:["25","30","20","35"], correct:1, topic:'Maths'},
  {q:"73. Which is an isosceles triangle?", a:["All sides equal","Two sides equal","No side equal","Right-angled only"], correct:1, topic:'Maths'},
  {q:"74. Round 6.78 to one decimal place.", a:["6.7","6.8","7.0","6.0"], correct:1, topic:'Maths'},
  {q:"75. Solve: 9 + 6 ÷ 3", a:["5","15","11","13"], correct:2, topic:'Maths'},
  {q:"76. Which is NOT a multiple of 3?", a:["12","14","9","21"], correct:1, topic:'Maths'},
  {q:"77. Area of rectangle l=5, w=8 is?", a:["13","40","80","26"], correct:1, topic:'Maths'},
  {q:"78. Value of π (approx)?", a:["2.14","3.14","4.13","1.41"], correct:1, topic:'Maths'},
  {q:"79. 2/3 + 1/6 = ?", a:["5/6","1","3/4","4/6"], correct:0, topic:'Maths'},
  {q:"80. Shape with 4 equal sides & 4 right angles?", a:["Rhombus","Rectangle","Square","Parallelogram"], correct:2, topic:'Maths'},

  {q:"81. First president of Nigeria (post-independence republic) was?", a:["Nnamdi Azikiwe","Nnamdi Azikwe","Obafemi Awolowo","Ahmadu Bello"], correct:0, topic:'GK'},
  {q:"82. Which Nigerian city is a major oil hub?", a:["Enugu","Port Harcourt","Kano","Kaduna"], correct:1, topic:'GK'},
  {q:"83. Currency of Nigeria is called?", a:["Cedi","Naira","Shilling","Dollar"], correct:1, topic:'GK'},
  {q:"84. Organelle known as powerhouse of the cell?", a:["Nucleus","Mitochondrion","Ribosome","Chloroplast"], correct:1, topic:'GK'},
  {q:"85. 'UNILAG' stands for?", a:["University of Lagos","United Lagos","University Lagos Group","Unions of Lagos"], correct:0, topic:'GK'},
  {q:"86. Who wrote Nigeria's national anthem (lyrics)?", a:["Lilian Jean Williams","John A. Ilechukwu","E. Okikiola Aremu","Muhammed"], correct:0, topic:'GK'},
  {q:"87. Which body conducts UTME/JAMB?", a:["UNILAG","JAMB","INEC","NYSC"], correct:1, topic:'GK'},
  {q:"88. Which is a renewable energy source?", a:["Coal","Petrol","Solar","Natural Gas"], correct:2, topic:'GK'},
  {q:"89. Which metal is liquid at room temperature?", a:["Mercury","Gold","Iron","Copper"], correct:0, topic:'GK'},
  {q:"90. Largest organ in the human body?", a:["Heart","Skin","Liver","Brain"], correct:1, topic:'GK'},

  {q:"91. Correctly spelled pair: 'Embarrass' and 'Occasion'", a:["Both correct","Both incorrect","Only first correct","Only second correct"], correct:0, topic:'English'},
  {q:"92. Closest in meaning to 'arduous'?", a:["Easy","Difficult","Swift","Short"], correct:1, topic:'English'},
  {q:"93. Fill: 'He _____ his homework before dinner.'", a:["has finished","had finished","have finished","will finish"], correct:1, topic:'English'},
  {q:"94. Which is a modal verb?", a:["Can","Run","House","Sun"], correct:0, topic:'English'},
  {q:"95. 'Each of the students ___ a book.'", a:["have","has","are","is"], correct:1, topic:'English'},
  {q:"96. Rearrange: 'always / he / on time / is' ->", a:["He is always on time.","Always he is on time.","He always on time is.","On time he is always."], correct:0, topic:'English'},
  {q:"97. Example of figurative language?", a:["It's raining cats and dogs.","I drank water.","He sits on the chair.","She eats rice."], correct:0, topic:'English'},
  {q:"98. Reported: 'She said, \"I am happy.\"' ->", a:["She said she was happy.","She said she is happy.","She said she will be happy.","She said I am happy."], correct:0, topic:'English'},
  {q:"99. Which uses the passive perfect?", a:["The letter has been sent.","She sends the letter.","They will send the letter.","She sending the letter."], correct:0, topic:'English'},
  {q:"100. Which exam is this mock for?", a:["JAMB UTME","UNILAG Post-UTME","WAEC","NECO"], correct:1, topic:'GK'}
];

/* ----------------------
   STATE
   ---------------------- */
let currentIndex = 0;
let answers = {};          // user answers: index -> selected option index
let flagged = new Set();   // flagged question indices
let started = false;
let timeLeft = 90*60;      // seconds
let timerId = null;

/* ----------------------
   DOM refs
   ---------------------- */
const qNumEl = document.getElementById('qNum');
const qSubjectEl = document.getElementById('qSubject');
const qTextEl = document.getElementById('qText');
const choicesArea = document.getElementById('choicesArea');
const progBar = document.getElementById('progBar');
const timerEl = document.getElementById('timer');
const answeredCountEl = document.getElementById('answeredCount');
const resultBox = document.getElementById('resultBox');
const breakdownEl = document.getElementById('breakdown');

/* ----------------------
   RENDERING
   ---------------------- */
function renderQuestion(i){
  const Q = QUESTIONS[i];
  qNumEl.textContent = `Q ${i+1}`;
  qSubjectEl.textContent = Q.topic;
  qTextEl.textContent = Q.q.replace(/^\d+\.\s*/,'');
  // choices
  choicesArea.innerHTML = Q.a.map((opt,idx)=>`
    <label class="choice">
      <input type="radio" name="choice" value="${idx}" ${answers[i]===idx ? 'checked' : ''} />
      <div><strong>${String.fromCharCode(65+idx)}.</strong>&nbsp; ${opt}</div>
    </label>
  `).join('');
  updateNavs();
  updateProgress();
}

function updateProgress(){
  const answered = Object.keys(answers).length;
  const pct = Math.round((answered/QUESTIONS.length)*100);
  progBar.style.width = pct + '%';
  answeredCountEl.textContent = answered;
}

function updateNavs(){
  const navs = document.getElementById('navs');
  navs.innerHTML = '';
  for(let i=0;i<QUESTIONS.length;i++){
    const btn = document.createElement('button');
    btn.className = 'qnav';
    btn.textContent = i+1;
    if(answers[i]!==undefined) btn.classList.add('answered');
    if(flagged.has(i)) btn.classList.add('flag');
    btn.onclick = ()=>{ currentIndex = i; renderQuestion(currentIndex); };
    navs.appendChild(btn);
  }
}

/* ----------------------
   EVENTS
   ---------------------- */
document.getElementById('startBtn').addEventListener('click', ()=>{
  if(!started){
    started = true;
    startTimer();
    renderQuestion(currentIndex);
    document.getElementById('startBtn').disabled = true;
    document.getElementById('startBtn').textContent = 'Exam started';
  }
});

choicesArea.addEventListener('change', (e)=>{
  if(e.target && e.target.matches('input[type=radio]')){
    answers[currentIndex] = parseInt(e.target.value);
    updateNavs();
    updateProgress();
  }
});

document.getElementById('nextBtn').addEventListener('click', ()=>{
  saveCurrentChoice();
  if(currentIndex < QUESTIONS.length-1){ currentIndex++; renderQuestion(currentIndex); }
});

document.getElementById('prevBtn').addEventListener('click', ()=>{
  saveCurrentChoice();
  if(currentIndex > 0){ currentIndex--; renderQuestion(currentIndex); }
});

document.getElementById('flagBtn').addEventListener('click', ()=>{
  if(flagged.has(currentIndex)) flagged.delete(currentIndex); else flagged.add(currentIndex);
  updateNavs();
});

document.getElementById('submitBtn').addEventListener('click', ()=>{
  if(!started){
    alert('You have not started the mock yet. Click Start Mock to begin.');
    return;
  }
  if(confirm('Submit exam and finish?')) finishExam();
});

document.getElementById('retryBtn').addEventListener('click', ()=>{
  if(confirm('Retry: Clear answers and restart timer?')){
    answers = {}; flagged = new Set(); currentIndex=0; timeLeft=90*60; resultBox.style.display='none';
    renderQuestion(currentIndex); updateProgress(); startTimer(true);
  }
});

document.getElementById('saveBtn').addEventListener('click', ()=>{
  const data = {timeLeft,answers,flagged:Array.from(flagged),currentIndex};
  localStorage.setItem('unilag_mock_save', JSON.stringify(data));
  alert('Progress saved locally on this device.');
});

document.getElementById('loadBtn').addEventListener('click', ()=>{
  const raw = localStorage.getItem('unilag_mock_save');
  if(!raw){ alert('No saved progress found.'); return; }
  const data = JSON.parse(raw);
  timeLeft = data.timeLeft || 90*60;
  answers = data.answers || {};
  flagged = new Set(data.flagged || []);
  currentIndex = data.currentIndex || 0;
  renderQuestion(currentIndex);
  updateProgress();
  alert('Progress loaded.');
});

document.getElementById('exportBtn').addEventListener('click', exportResults);

/* ----------------------
   HELPERS
   ---------------------- */
function saveCurrentChoice(){
  const selected = document.querySelector('input[name=choice]:checked');
  if(selected) answers[currentIndex] = parseInt(selected.value);
  updateNavs(); updateProgress();
}

function startTimer(restart=false){
  if(timerId) clearInterval(timerId);
  if(restart){
    // timeLeft assumed reset by caller
  }
  timerId = setInterval(()=>{
    if(timeLeft <= 0){ clearInterval(timerId); finishExam(); return; }
    timeLeft--;
    const m = Math.floor(timeLeft/60); const s = timeLeft%60;
    timerEl.textContent = `${String(m).padStart(2,'0')}:${String(s).padStart(2,'0')}`;
  },1000);
}

/* Grading */
function grade(){
  let correct=0; let breakdown={English:0,Maths:0,GK:0,Logic:0}; let totals={English:0,Maths:0,GK:0,Logic:0};
  for(let i=0;i<QUESTIONS.length;i++){
    const Q = QUESTIONS[i];
    totals[Q.topic] = (totals[Q.topic]||0)+1;
    const ans = answers[i];
    if(ans!==undefined && ans===Q.correct){
      correct++;
      breakdown[Q.topic] = (breakdown[Q.topic]||0)+1;
    }
  }
  return {correct,breakdown,totals};
}

function finishExam(){
  saveCurrentChoice();
  if(timerId) clearInterval(timerId);
  const res = grade();
  const scoreText = document.getElementById('scoreText');
  scoreText.textContent = `You scored ${res.correct} / ${QUESTIONS.length} (${Math.round((res.correct/QUESTIONS.length)*100)}%)`;
  breakdownEl.innerHTML = '';
  for(const t of ['English','Maths','GK','Logic']){
    if(res.totals[t]){
      const got = res.breakdown[t]||0; const tot = res.totals[t];
      const el = document.createElement('div'); el.className='badge'; el.textContent = `${t}: ${got}/${tot}`; breakdownEl.appendChild(el);
    }
  }
  resultBox.style.display = 'block';
  window.scrollTo(0,document.body.scrollHeight);
}

/* Export results to JSON */
function exportResults(){
  const res = grade();
  const payload = {score:res.correct,total:QUESTIONS.length,percent:Math.round((res.correct/QUESTIONS.length)*100),answers,flagged:Array.from(flagged),timeTaken:(90*60 - timeLeft)};
  const blob = new Blob([JSON.stringify(payload,null,2)],{type:'application/json'});
  const url = URL.createObjectURL(blob); const a=document.createElement('a'); a.href=url; a.download='unilag_mock_results.json'; a.click(); URL.revokeObjectURL(url);
}

/* ----------------------
   INIT
   ---------------------- */
(function init(){
  timerEl.textContent = '90:00';
  renderQuestion(currentIndex);
  updateNavs();
  updateProgress();
})();
</script>
</body>
</html>
